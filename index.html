<!DOCTYPE html>
<html lang="en"> <head>
  <meta charset="utf-8">
  <title>D3 Page Template</title>
  <script type="text/javascript" src="d3.js"></script>

  <style>

  .nodes circle {
  stroke: #fff;
  stroke-width: 1.5px;
}

  </style>
</head>
<body>
  <h3>visualization based on web history</h3>
  <script type="text/javascript">


   const w = 10000;
   const h = 10000;


 d3.json("results.json").then(function(data) {
  var dataset = data

  var force = d3.forceSimulation(dataset.nodes)
          //attraction or repeltion of all the nodes
          .force("charge", d3.forceManyBody().strength(-50))
          //distance of edges & forces of connecting nodes
          .force("link", d3.forceLink().links(dataset.edges).distance(50))
          .force("center", d3.forceCenter().x(w/2).y(h/2))
          .force("collision", d3.forceCollide().radius(10));

//preset color scheme
   var colors = d3.scaleOrdinal(d3.schemeCategory10);

  //Create SVG element
  var svg = d3.select("body")
        .append("svg")
        .attr("width", w)
        .attr("height", h);

  //Create edges as lines
  var edges = svg.selectAll("line")
    .data(dataset.edges)
    .enter()
    .append("line")
    .style("stroke", "#ccc")
    .style("stroke-width", 1);

    var node = svg.append("g")
          .attr("class", "nodes")
        .selectAll("g")
        .data(dataset.nodes)
        .enter().append("g")

    var circles = node.append("circle")
          .attr("r", 5)
          .attr("fill", function(d,i) { return colors(i); })


  //Create nodes as circles
  // var node = svg.append("g")
  //   .selectAll("circle")
  //   .data(dataset.nodes)
  //   .enter()
  //   .append("circle")
  //   .attr("r", function(d, i){
  //     if(d.secondLevelDomain == 'design'){
  //       return 10;
  //     }
  //     return 5;
  //   })
  //   .style("fill", function(d, i) {
  //     if(d.secondLevelDomain == 'design'){
  //       return "black";
  //     }
  //     return colors(i);
  //   });

  //Add a simple tooltip
  node.append("title")
     .text(function(d) {
      return d.name;
     });

  node.append("text")
  .text(function(d) {
   return d.name;
  })
  .attr('font-size', 15)
  .attr('dx', 15)
  .attr('dy', 4)


  //Every time the simulation "ticks", this will be called
  force.on("tick", function() {

    edges.attr("x1", function(d) { return d.source.x; })
       .attr("y1", function(d) { return d.source.y; })
       .attr("x2", function(d) { return d.target.x; })
       .attr("y2", function(d) { return d.target.y; });

    node.attr("transform", function(d) {
          return "translate(" + d.x + "," + d.y + ")";
        })
  });

 }); 

  </script>
</body>
</html>
